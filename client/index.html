<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>CodeSignal Linear Algebra Playground</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Fonts (Work Sans from Google, Founders Grotesk via typography.css) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Design System Foundations -->
  <link rel="stylesheet" href="./design-system/colors/colors.css">
  <link rel="stylesheet" href="./design-system/spacing/spacing.css">
  <link rel="stylesheet" href="./design-system/typography/typography.css">

  <!-- Design System Components -->
  <link rel="stylesheet" href="./design-system/components/button/button.css">
  <link rel="stylesheet" href="./design-system/components/boxes/boxes.css">
  <link rel="stylesheet" href="./design-system/components/input/input.css">
  <link rel="stylesheet" href="./design-system/components/dropdown/dropdown.css">
  <link rel="stylesheet" href="./design-system/components/numeric-slider/numeric-slider.css">

  <!-- App-specific overrides -->
  <link rel="stylesheet" href="./bespoke.css" />
  <link rel="stylesheet" href="./layout.css" />
  <link rel="stylesheet" href="./vector-mode.css" />
  <link rel="stylesheet" href="./matrix-mode.css" />
  <link rel="stylesheet" href="./tensor-mode.css" />
</head>

<body class="bespoke">
  <!-- Navigation Header -->
  <header class="header">
    <h1 class="heading-xsmall">CodeSignal Linear Algebra Playground</h1>
    <div class="mode-switcher">
      <!-- Mode buttons will be dynamically generated by ModeManager -->
    </div>
    <div class="spacer"></div>
    <div id="status" class="status body-xsmall">Ready</div>
    <button id="btn-help" class="button button-text">Help</button>
  </header>

  <!-- Main Application Content -->
  <main class="main-container">
    <!-- Left Sidebar: Control Panel -->
    <aside class="sidebar">
      <!-- Vector Mode Content -->
      <div class="mode-content" data-mode="vector">
        <div class="sidebar-section">
          <div class="section-header">
            <div id="coord-mode-dropdown"></div>
            <button id="canvas-reset" class="button button-secondary button-small">Reset </button>
          </div>
          <!-- Vector 1 -->
          <div class="vector-control" id="vector1-control">
            <h3 class="body-medium">Vector 1 <span class="vector-label v1-color">v₁</span></h3>
            <div class="vector-info">
              <div class="info-row body-xsmall">
                <span class="label">Coordinates:</span>
                <span id="v1-coords" class="value">Not created</span>
              </div>
              <div class="info-row body-xsmall">
                <span class="label">Magnitude:</span>
                <span id="v1-magnitude" class="value">—</span>
              </div>
            </div>
            <!-- Reflection Control -->
            <div class="reflection-control" data-operation-group="reflection">
              <div id="reflect-type-v1-dropdown"></div>
              <button id="op-reflect-v1" class="button button-primary btn-reflect" disabled>Reflect</button>
            </div>
          </div>

          <!-- Vector 2 -->
          <div class="vector-control" id="vector2-control">
            <h3 class="body-medium">Vector 2 <span class="vector-label v2-color">v₂</span></h3>
            <div class="vector-info">
              <div class="info-row body-xsmall">
                <span class="label">Coordinates:</span>
                <span id="v2-coords" class="value">Not created</span>
              </div>
              <div class="info-row body-xsmall">
                <span class="label">Magnitude:</span>
                <span id="v2-magnitude" class="value">—</span>
              </div>
            </div>
            <!-- Reflection Control -->
            <div class="reflection-control" data-operation-group="reflection">
              <div id="reflect-type-v2-dropdown"></div>
              <button id="op-reflect-v2" class="button button-primary btn-reflect" disabled>Reflect</button>
            </div>
          </div>
        </div>

        <!-- Operations Section -->
        <div class="sidebar-section">
          <h2 class="heading-small">Operations</h2>

          <div class="operation-group" data-operation-group="addition">
            <div class="operation-label">
              <span>Addition & Subtraction</span>
            </div>
            <button id="op-add" class="button button-primary" disabled>Add v₁ + v₂</button>
            <button id="op-subtract" class="button button-primary" disabled>Subtract v₁ - v₂</button>
          </div>

          <div class="operation-group" data-operation-group="scalarMultiplication">
            <div class="operation-label">
              <span>Scalar Multiplication</span>
            </div>
            <div class="scalar-control">
              <input type="number" id="scalar-input" class="input" value="2" step="0.1" />
              <span class="times-symbol body-large">×</span>
              <div id="scale-vector-dropdown"></div>
              <button id="op-scale" class="button button-primary btn-scale" disabled>Scale</button>
            </div>
          </div>

          <div class="operation-group" data-operation-group="dotProduct">
            <div class="operation-label">
              <span>Dot Product</span>
            </div>
            <button id="op-dot" class="button button-primary" disabled>v₁ · v₂</button>
          </div>

          <div class="operation-group" data-operation-group="projectionAngle">
            <div class="operation-label">
              <span>Projection & Angle</span>
            </div>
            <button id="op-project" class="button button-primary" disabled>Project v₁ onto v₂</button>
            <button id="op-angle" class="button button-primary" disabled>Angle Between v₁ & v₂</button>
          </div>

          <div class="operation-group" data-operation-group="normalization">
            <div class="operation-label">
              <span>Normalization</span>
            </div>
            <div class="normalize-control">
              <div id="normalize-vector-dropdown"></div>
              <button id="op-normalize" class="button button-primary btn-normalize" disabled>Normalize</button>
            </div>
          </div>

          <div class="operation-group" data-operation-group="perpendicular">
            <div class="operation-label">
              <span>Perpendicular Vector</span>
            </div>
            <div class="perpendicular-control">
              <div id="perpendicular-vector-dropdown"></div>
              <button id="op-perpendicular" class="button button-primary btn-perpendicular" disabled>Show Perpendicular</button>
            </div>
          </div>

          <div class="operation-group" data-operation-group="linearCombination">
            <div class="operation-label">
              <span>Linear Combination</span>
            </div>
            <div class="linear-combo-control">
              <div id="lc-scalar-a"></div>
              <div id="lc-scalar-b"></div>
              <button id="op-linear-combo" class="button button-primary" disabled>1v₁ + 1v₂</button>
            </div>
          </div>
        </div>
      </div>
      <!-- End Vector Mode Content -->

      <!-- Matrix Mode Content -->
      <div class="mode-content" data-mode="matrix">
        <div class="sidebar-section">
          <div class="section-header">
            <div></div>
            <button id="matrix-reset" class="button button-secondary button-small">Reset</button>
          </div>

          <!-- Matrix Input Grid -->
          <div class="matrix-input-section">
            <div class="matrix-display-wrapper">
              <div class="matrix-label">
                <span class="matrix-name">A</span>
                <span class="matrix-equals">=</span>
                <span class="matrix-brackets">[</span>
                <span class="matrix-basis-vector matrix-col-i">î<sub>A</sub></span>
                <span class="matrix-basis-vector matrix-col-j">ĵ<sub>A</sub></span>
                <span class="matrix-brackets">]</span>
              </div>
              <div class="matrix-grid">
                <div class="matrix-column-headers">
                  <span class="matrix-column-label matrix-col-i">î<sub>A</sub></span>
                  <span class="matrix-column-label matrix-col-j">ĵ<sub>A</sub></span>
                </div>
                <div class="matrix-row">
                  <input type="number" id="m00" class="input matrix-input matrix-col-i" value="1" step="0.1">
                  <input type="number" id="m01" class="input matrix-input matrix-col-j" value="0" step="0.1">
                </div>
                <div class="matrix-row">
                  <input type="number" id="m10" class="input matrix-input matrix-col-i" value="0" step="0.1">
                  <input type="number" id="m11" class="input matrix-input matrix-col-j" value="1" step="0.1">
                </div>
              </div>
            </div>
            <div class="matrix-display-wrapper" id="matrix-b-wrapper">
              <div class="matrix-label">
                <span class="matrix-name">B</span>
                <span class="matrix-equals">=</span>
                <span class="matrix-brackets">[</span>
                <span class="matrix-basis-vector matrix-col-i matrix-col-b">î<sub>B</sub></span>
                <span class="matrix-basis-vector matrix-col-j matrix-col-b">ĵ<sub>B</sub></span>
                <span class="matrix-brackets">]</span>
              </div>
              <div class="matrix-grid">
                <div class="matrix-column-headers">
                  <span class="matrix-column-label matrix-col-i matrix-col-b">î<sub>B</sub></span>
                  <span class="matrix-column-label matrix-col-j matrix-col-b">ĵ<sub>B</sub></span>
                </div>
                <div class="matrix-row">
                  <input type="number" id="m00_b" class="input matrix-input matrix-col-i matrix-col-b" value="1" step="0.1">
                  <input type="number" id="m01_b" class="input matrix-input matrix-col-j matrix-col-b" value="0" step="0.1">
                </div>
                <div class="matrix-row">
                  <input type="number" id="m10_b" class="input matrix-input matrix-col-i matrix-col-b" value="0" step="0.1">
                  <input type="number" id="m11_b" class="input matrix-input matrix-col-j matrix-col-b" value="1" step="0.1">
                </div>
              </div>
            </div>
            <div class="vector-input-wrapper" id="vector-v-wrapper" style="display: none;">
              <div class="matrix-label">
                <span class="matrix-name">v</span>
                <span class="matrix-equals">=</span>
                <span class="matrix-brackets">[</span>
                <span class="vector-component-label vector-col-x">x</span>
                <span class="vector-component-label vector-col-y">y</span>
                <span class="matrix-brackets">]</span>
              </div>
              <div class="matrix-grid">
                <div class="matrix-column-headers">
                  <span class="matrix-column-label vector-col-x">v</span>
                </div>
                <div class="matrix-row">
                  <input type="number" id="vector-vx" class="input vector-input matrix-input vector-col-x" value="1"
                    step="0.1">
                </div>
                <div class="matrix-row">
                  <input type="number" id="vector-vy" class="input vector-input matrix-input vector-col-y" value="1"
                    step="0.1">
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Operations Section -->
        <div class="sidebar-section">
          <h2 class="heading-small">Operations</h2>

          <div class="operation-group" data-operation-group="addition">
            <div class="operation-label">
              <span>Addition</span>
            </div>
            <button id="op-matrix-add" class="button button-primary" disabled>Add A + B</button>
          </div>

          <div class="operation-group" data-operation-group="scalarMultiplication">
            <div class="operation-label">
              <span>Scalar Multiplication</span>
            </div>
            <div class="scalar-control">
              <input type="number" id="matrix-scalar-input" class="input" value="2" step="0.1" />
              <span class="times-symbol body-large">×</span>
              <div id="matrix-scalar-dropdown"></div>
              <button id="op-matrix-scale" class="button button-primary btn-scale" disabled>Scale</button>
            </div>
          </div>

          <div class="operation-group" data-operation-group="multiplication">
            <div class="operation-label">
              <span>Matrix Multiplication</span>
            </div>
            <button id="op-matrix-multiply" class="button button-primary" disabled>Multiply A @ B</button>
          </div>

          <div class="operation-group" data-operation-group="linearTransformation">
            <div class="operation-label">
              <span>Linear Transformation</span>
            </div>
            <button id="op-compute-ax" class="button button-primary" disabled>Compute Ax</button>
          </div>

          <div class="operation-group" data-operation-group="determinant">
            <div class="operation-label">
              <span>Determinant</span>
            </div>
            <div class="determinant-control">
              <div id="determinant-matrix-dropdown"></div>
              <button id="show-determinant" class="button button-primary btn-determinant">Show Area</button>
            </div>
          </div>
        </div>
      </div>
      <!-- End Matrix Mode Content -->

      <!-- Tensor Mode Content -->
      <div class="mode-content" data-mode="tensor">
        <!-- Content injected by TensorMode class -->
      </div>
      <!-- End Tensor Mode Content -->
    </aside>

    <!-- Canvas: Cartesian Plane -->
    <div class="canvas-container">
      <canvas id="grid-canvas"></canvas>

      <!-- Vector Mode Results Overlay -->
      <div id="vector-results"
           class="results-overlay pos-top-left"
           role="complementary"
           aria-label="Operation results"
           aria-live="polite">
        <div class="results-overlay-header">
          <h3 class="results-title body-small">Results</h3>
          <div class="results-controls">
            <button class="results-collapse" aria-label="Collapse">⌄</button>
          </div>
        </div>
        <div class="results-content">
          <p class="hint">Perform an operation to see results</p>
        </div>
      </div>

      <!-- Matrix Mode Results Overlay -->
      <div id="matrix-results"
           class="results-overlay pos-top-left"
           role="complementary"
           aria-label="Operation results"
           aria-live="polite">
        <div class="results-overlay-header">
          <h3 class="results-title body-small">Results</h3>
          <div class="results-controls">
            <button class="results-collapse" aria-label="Collapse">⌄</button>
          </div>
        </div>
        <div class="results-content">
          <p class="hint">Operations results will be displayed here</p>
        </div>
      </div>
    </div>
  </main>

  <!-- Help Modal (automatically managed by help-modal.js) -->
  <!-- The modal structure is created dynamically by the JavaScript -->

  <!-- Core Scripts -->
  <script src="./help-modal.js"></script>
  <script src="./logger.js"></script>

  <!-- Core Infrastructure (must load before modes) -->
  <script src="./core/status.js"></script>
  <script src="./core/config.js"></script>
  <script src="./core/operation-schemas.js"></script>
  <script src="./core/help.js"></script>
  <script src="./core/mode-manager.js"></script>
  <script src="./core/color-utils.js"></script>
  <script src="./core/theme-service.js"></script>
  <script src="./core/results-panel.js"></script>
  <script src="./core/format-utils.js"></script>
  <script src="./core/vector.js"></script>
  <script src="./core/animator.js"></script>
  <script src="./core/coordinate-system.js"></script>
  <script src="./app.js"></script>

  <!-- Mathematical Entities -->
  <script src="./entities/matrix.js"></script>

  <!-- Design System Components -->
  <script type="module" src="./design-system/components/dropdown/dropdown.js"></script>
  <script type="module" src="./design-system/components/numeric-slider/numeric-slider.js"></script>

  <!-- Mode Implementations -->
  <script src="./modes/vector-sidebar.js"></script>
  <script src="./modes/vector-canvas.js"></script>
  <script src="./modes/vector-operations.js"></script>
  <script src="./modes/vector-mode.js"></script>
  <script src="./modes/matrix-operations.js"></script>
  <script src="./modes/matrix-mode.js"></script>
  <script src="./modes/tensor-canvas-3d.js"></script>
  <script src="./modes/tensor-mode.js"></script>

  <!-- Main Application -->
  <script src="./linear-algebra.js"></script>
</body>

</html>